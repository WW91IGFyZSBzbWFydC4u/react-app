{"ast":null,"code":"import _regeneratorRuntime from\"D:/temp_e/Projects/React/mythirdapp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/temp_e/Projects/React/mythirdapp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _classCallCheck from\"D:/temp_e/Projects/React/mythirdapp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/temp_e/Projects/React/mythirdapp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"D:/temp_e/Projects/React/mythirdapp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"D:/temp_e/Projects/React/mythirdapp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import Dashboard from'./Dashboard';import'./Dashboard.scss';import{Table,Button,Form}from'tabler-react';import{Modal}from'react-bootstrap';var Wallet=/*#__PURE__*/function(_React$Component){_inherits(Wallet,_React$Component);var _super=_createSuper(Wallet);function Wallet(props){var _this;_classCallCheck(this,Wallet);_this=_super.call(this,props);_this.onWDsubmit=function(event){event.preventDefault();var fields=_this.state.fields;console.log(fields['address']);console.log(/^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,39}$/.test(fields['address']));console.log(fields['amount']);console.log(/^\\d+(.\\d+)*$/.test(fields['amount']));// Address\nif(!/^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,39}$/.test(fields['address'])){// Reset Address\nalert('Enter a valid BTC Address');return;}if(!/^\\d+(.\\d+)*$/.test(fields['amount'])){alert('Enter a valid numeric amount to pay out');return;}document.getElementById(\"divHint\").style.display=\"inline-block\";return;};_this.modalShow=false;_this.modalShowWD=false;_this.state={fields:{},walletvalue:0,totalbtc:0,approved:{address:[],date:[]}};return _this;}_createClass(Wallet,[{key:\"renderApproved\",value:function renderApproved(){var obj=this.state.approved;var cnt=0;try{Object.keys(obj).map(function(){console.log(cnt);console.log('approvingwall');console.log(obj.address[cnt]);console.log(obj.date[cnt]);cnt+=1;return/*#__PURE__*/_jsxs(Table.Row,{children:[\"  \",/*#__PURE__*/_jsx(Table.Col,{children:\"1\"}),\" \",/*#__PURE__*/_jsx(Table.Col,{children:\"2\"}),\" \"]});});}catch(e){console.log(e);return;}return;for(var i=0;i<this.state.approved.address.length;i++){try{console.log('approvingwall');return/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Col,{children:this.state.approved.address[i]}),/*#__PURE__*/_jsx(Table.Col,{children:this.state.approved.date[i]})]});}catch(e){console.log(e);return;}}}},{key:\"componentWillMount\",value:function(){var _componentWillMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,result,i,res2,result2,res3,result3,k;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch('/overview',{method:'post',headers:{'Accept':'applcication/json','Content-Type':'applcication/json'}});case 3:res=_context.sent;_context.next=6;return res.json();case 6:result=_context.sent;console.log('start btc calc');for(i=0;i<result.data.length;i++){if(result.data[i].type==1){this.state.totalbtc+=result.data[i].amount;}else{this.state.totalbtc-=result.data[i].amount;}}console.log(this.state.totalbtc);console.log('end btc calc');console.log('start get conversion');_context.next=14;return fetch('https://blockchain.info/tobtc?currency=USD&value=1');case 14:res2=_context.sent;_context.next=17;return res2.json();case 17:result2=_context.sent;console.log(result2);console.log('end get conversion');this.state.usdbtc=Number.parseFloat(1/result2).toFixed(2);this.state.walletvalue=Number.parseFloat(this.state.totalbtc*this.state.usdbtc).toFixed(2);console.log(this.state.usdbtc);console.log(this.state.walletvalue);_context.next=26;return fetch('/approvedWallets',{method:'post',headers:{'Accept':'applcication/json','Content-Type':'applcication/json'}});case 26:res3=_context.sent;_context.next=29;return res3.json();case 29:result3=_context.sent;console.log(\"result\");console.log(result3);console.log(result3.data.length);for(k=0;k<result3.data.length;k++){this.state.approved.address.push(result3.data[k].address);this.state.approved.date.push(result3.data[k].approveDate);//this.state.approved.address.push(result3.data[k].address)\n//this.state.approved.date.push(result3.data[k].approveDate);\n}console.log(\"filled approved state:\");console.log(this.state.approved);this.forceUpdate();_context.next=43;break;case 39:_context.prev=39;_context.t0=_context[\"catch\"](0);console.log('exc');console.log(_context.t0);case 43:case\"end\":return _context.stop();}}},_callee,this,[[0,39]]);}));function componentWillMount(){return _componentWillMount.apply(this,arguments);}return componentWillMount;}()},{key:\"handleChange\",value:function handleChange(field,e){var fields=this.state.fields;fields[field]=e.target.value;this.setState({fields:fields});}},{key:\"switchModalShow\",value:function switchModalShow(){this.modalShow=!this.modalShow;console.log(\"modalshow = \"+this.modalShow);this.forceUpdate();return;}},{key:\"switchModalWDShow\",value:function switchModalWDShow(){this.modalShowWD=!this.modalShowWD;console.log(\"modalshow = \"+this.modalShowWD);this.forceUpdate();return;}},{key:\"USD\",value:function USD(value,USDexchange){return value*USDexchange;}},{key:\"render\",value:function render(){var _this2=this;console.log('render called');return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table\",children:[/*#__PURE__*/_jsxs(Table,{highlightRowOnHover:true,children:[/*#__PURE__*/_jsxs(Table.Header,{children:[/*#__PURE__*/_jsx(Table.ColHeader,{children:\"Type\"}),/*#__PURE__*/_jsx(Table.ColHeader,{children:\"Friendly Name\"}),/*#__PURE__*/_jsx(Table.ColHeader,{children:\"Address\"}),/*#__PURE__*/_jsx(Table.ColHeader,{children:\"Value\"}),/*#__PURE__*/_jsx(Table.ColHeader,{children:\"Value in USD\"}),/*#__PURE__*/_jsx(Table.ColHeader,{children:\"Actions\"})]}),/*#__PURE__*/_jsx(Table.Body,{children:/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Col,{children:/*#__PURE__*/_jsx(\"h4\",{children:\"BTC\"})}),/*#__PURE__*/_jsx(Table.Col,{children:\"Long-Time-Storage\"}),/*#__PURE__*/_jsx(Table.Col,{children:\"bc1qm6qv2jdgjmt4krahrw9wpcyt5mmt7g8h5hz0av\"}),/*#__PURE__*/_jsxs(Table.Col,{children:[this.state.totalbtc,\" BTC\"]}),/*#__PURE__*/_jsxs(Table.Col,{children:[this.state.walletvalue,\" $\"]}),/*#__PURE__*/_jsxs(Table.Col,{children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return _this2.switchModalShow();},color:\"primary\",children:\"Deposit\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return _this2.switchModalWDShow();},color:\"secondary\",children:\"Withdraw\"})]})]})})]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Approved Addresses\"}),/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsxs(Table.Header,{children:[/*#__PURE__*/_jsx(Table.ColHeader,{children:\"Address\"}),/*#__PURE__*/_jsx(Table.ColHeader,{children:\"Approval Date\"})]}),/*#__PURE__*/_jsxs(Table.Body,{children:[this.renderApproved(),/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Col,{children:\"bc1qm6****5884\"}),/*#__PURE__*/_jsx(Table.Col,{children:\"2019-10-10\"})]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{classname:\"modalD\",children:/*#__PURE__*/_jsxs(Modal,{show:this.modalShow,\"aria-labelledby\":\"contained-modal-title-vcenter\",children:[/*#__PURE__*/_jsx(Modal.Header,{children:/*#__PURE__*/_jsx(Modal.Title,{id:\"contained-modal-title-vcenter\",children:\"Deposit to Wallet\"})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"To deposit to this wallet, please use the following address:\"}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"b\",{children:\"bc1qm6qv2jdgjmt4krahrw9wpcyt5mmt7g8h5hz0av\"})}),/*#__PURE__*/_jsx(\"p\",{children:\" \"}),/*#__PURE__*/_jsx(\"p\",{children:\"Note: For safety reasons it is required to deposit a set amount of BTC to enable withdrawing to a new address.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"This process only needs to be done once.\"})]}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return _this2.switchModalShow();},children:\"Close\"})})]})}),/*#__PURE__*/_jsx(\"div\",{classname:\"modalWD\",children:/*#__PURE__*/_jsxs(Modal,{show:this.modalShowWD,\"aria-labelledby\":\"contained-modal-title-vcenter\",children:[/*#__PURE__*/_jsx(Modal.Header,{children:/*#__PURE__*/_jsx(Modal.Title,{id:\"contained-modal-title-vcenter\",children:\"Withdraw from Wallet\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsx(\"div\",{classname:\"withdrawalForm\",children:/*#__PURE__*/_jsxs(Form,{onSubmit:this.onWDsubmit.bind(this),children:[/*#__PURE__*/_jsxs(Form.FieldSet,{children:[/*#__PURE__*/_jsx(Form.Input,{id:\"address\",name:\"address\",label:\"Address\",placeholder:\"Receiving Address\",maxLength:\"35\",icon:\"credit-card\",type:\"text\",onChange:this.handleChange.bind(this,\"address\")}),/*#__PURE__*/_jsx(Form.Input,{id:\"amount\",name:\"amount\",label:\"Amount\",placeholder:\"(BTC) Withdrawal Amount\",icon:\"dollar-sign\",onChange:this.handleChange.bind(this,\"amount\"),required:true}),/*#__PURE__*/_jsx(Button,{name:\"submit\",type:\"submit\",color:\"primary\",children:\"Withdraw\"})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"divHint\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"For safety reasons it is required to approve new addresses before withdrawing is allowed.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"A new address is approved by a deposit surpassing the configured limit (0.02 BTC).\"}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"b\",{children:\"Approved Addresses have no withdrawal limit.\"})})]})]})})}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return _this2.switchModalWDShow();},children:\"Close\"})})]})})]});}}]);return Wallet;}(React.Component);export default Wallet;","map":{"version":3,"sources":["D:/temp_e/Projects/React/mythirdapp/frontend/src/Dashboard/Wallet.js"],"names":["React","Dashboard","Table","Button","Form","Modal","Wallet","props","onWDsubmit","event","preventDefault","fields","state","console","log","test","alert","document","getElementById","style","display","modalShow","modalShowWD","walletvalue","totalbtc","approved","address","date","obj","cnt","Object","keys","map","e","i","length","fetch","method","headers","res","json","result","data","type","amount","res2","result2","usdbtc","Number","parseFloat","toFixed","res3","result3","k","push","approveDate","forceUpdate","field","target","value","setState","USDexchange","switchModalShow","switchModalWDShow","renderApproved","bind","handleChange","Component"],"mappings":"uhCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,SAAP,KAAsB,aAAtB,CACA,MAAO,kBAAP,CACA,OAASC,KAAT,CAAgBC,MAAhB,CAAwBC,IAAxB,KAAoC,cAApC,CACA,OAASC,KAAT,KAAsB,iBAAtB,C,GAGMC,CAAAA,M,4GACF,gBAAYC,KAAZ,CAAmB,wCACf,uBAAMA,KAAN,EADe,MAyHnBC,UAzHmB,CAyHN,SAACC,KAAD,CAAW,CACpBA,KAAK,CAACC,cAAN,GACA,GAAIC,CAAAA,MAAM,CAAG,MAAKC,KAAL,CAAWD,MAAxB,CAEAE,OAAO,CAACC,GAAR,CAAYH,MAAM,CAAC,SAAD,CAAlB,EACAE,OAAO,CAACC,GAAR,CAAY,uCAAuCC,IAAvC,CAA4CJ,MAAM,CAAC,SAAD,CAAlD,CAAZ,EACAE,OAAO,CAACC,GAAR,CAAYH,MAAM,CAAC,QAAD,CAAlB,EACAE,OAAO,CAACC,GAAR,CAAY,eAAeC,IAAf,CAAoBJ,MAAM,CAAC,QAAD,CAA1B,CAAZ,EAEA;AACA,GAAI,CAAC,uCAAuCI,IAAvC,CAA4CJ,MAAM,CAAC,SAAD,CAAlD,CAAL,CAAqE,CACjE;AACAK,KAAK,CAAC,2BAAD,CAAL,CACA,OACH,CAED,GAAI,CAAC,eAAeD,IAAf,CAAoBJ,MAAM,CAAC,QAAD,CAA1B,CAAL,CAA4C,CACxCK,KAAK,CAAC,yCAAD,CAAL,CACA,OACH,CAEDC,QAAQ,CAACC,cAAT,CAAwB,SAAxB,EAAmCC,KAAnC,CAAyCC,OAAzC,CAAmD,cAAnD,CACA,OACH,CAhJkB,CAEf,MAAKC,SAAL,CAAiB,KAAjB,CACA,MAAKC,WAAL,CAAmB,KAAnB,CACA,MAAKV,KAAL,CAAa,CACTD,MAAM,CAAE,EADC,CAETY,WAAW,CAAE,CAFJ,CAGTC,QAAQ,CAAE,CAHD,CAITC,QAAQ,CAAE,CACNC,OAAO,CAAE,EADH,CAENC,IAAI,CAAE,EAFA,CAJD,CAAb,CAJe,aAclB,C,0EAEgB,CACb,GAAIC,CAAAA,GAAG,CAAG,KAAKhB,KAAL,CAAWa,QAArB,CACA,GAAII,CAAAA,GAAG,CAAG,CAAV,CACA,GAAI,CACAC,MAAM,CAACC,IAAP,CAAYH,GAAZ,EAAiBI,GAAjB,CAAqB,UAAY,CAC7BnB,OAAO,CAACC,GAAR,CAAYe,GAAZ,EACAhB,OAAO,CAACC,GAAR,CAAY,eAAZ,EACAD,OAAO,CAACC,GAAR,CAAYc,GAAG,CAACF,OAAJ,CAAYG,GAAZ,CAAZ,EACAhB,OAAO,CAACC,GAAR,CAAYc,GAAG,CAACD,IAAJ,CAASE,GAAT,CAAZ,EACAA,GAAG,EAAG,CAAN,CACA,mBAAO,MAAC,KAAD,CAAO,GAAP,8BAAa,KAAC,KAAD,CAAO,GAAP,gBAAb,kBAAsC,KAAC,KAAD,CAAO,GAAP,gBAAtC,OAAP,CACH,CAPD,EAQH,CACD,MAAOI,CAAP,CAAU,CACNpB,OAAO,CAACC,GAAR,CAAYmB,CAAZ,EACA,OACH,CAGD,OAEA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKtB,KAAL,CAAWa,QAAX,CAAoBC,OAApB,CAA4BS,MAAhD,CAAwDD,CAAC,EAAzD,CAA6D,CACzD,GAAI,CACArB,OAAO,CAACC,GAAR,CAAY,eAAZ,EACA,mBACI,MAAC,KAAD,CAAO,GAAP,yBACI,KAAC,KAAD,CAAO,GAAP,WAAY,KAAKF,KAAL,CAAWa,QAAX,CAAoBC,OAApB,CAA4BQ,CAA5B,CAAZ,EADJ,cAEI,KAAC,KAAD,CAAO,GAAP,WAAY,KAAKtB,KAAL,CAAWa,QAAX,CAAoBE,IAApB,CAAyBO,CAAzB,CAAZ,EAFJ,GADJ,CAMH,CACD,MAAOD,CAAP,CAAU,CACNpB,OAAO,CAACC,GAAR,CAAYmB,CAAZ,EACA,OACH,CACJ,CACJ,C,mVAKuBG,CAAAA,KAAK,CAAC,WAAD,CAAc,CAC/BC,MAAM,CAAE,MADuB,CAE/BC,OAAO,CAAE,CACL,SAAU,mBADL,CAEL,eAAgB,mBAFX,CAFsB,CAAd,C,QAAjBC,G,qCAQeA,CAAAA,GAAG,CAACC,IAAJ,E,QAAfC,M,eACJ5B,OAAO,CAACC,GAAR,CAAY,gBAAZ,EACA,IAASoB,CAAT,CAAa,CAAb,CAAgBA,CAAC,CAAGO,MAAM,CAACC,IAAP,CAAYP,MAAhC,CAAwCD,CAAC,EAAzC,CAA6C,CACzC,GAAIO,MAAM,CAACC,IAAP,CAAYR,CAAZ,EAAeS,IAAf,EAAuB,CAA3B,CAA8B,CAC1B,KAAK/B,KAAL,CAAWY,QAAX,EAAuBiB,MAAM,CAACC,IAAP,CAAYR,CAAZ,EAAeU,MAAtC,CACH,CAFD,IAGK,CACD,KAAKhC,KAAL,CAAWY,QAAX,EAAuBiB,MAAM,CAACC,IAAP,CAAYR,CAAZ,EAAeU,MAAtC,CACH,CACJ,CACD/B,OAAO,CAACC,GAAR,CAAY,KAAKF,KAAL,CAAWY,QAAvB,EACAX,OAAO,CAACC,GAAR,CAAY,cAAZ,EACAD,OAAO,CAACC,GAAR,CAAY,sBAAZ,E,uBACiBsB,CAAAA,KAAK,CAAC,oDAAD,C,SAAlBS,I,sCACgBA,CAAAA,IAAI,CAACL,IAAL,E,SAAhBM,O,eACJjC,OAAO,CAACC,GAAR,CAAYgC,OAAZ,EACAjC,OAAO,CAACC,GAAR,CAAY,oBAAZ,EACA,KAAKF,KAAL,CAAWmC,MAAX,CAAoBC,MAAM,CAACC,UAAP,CAAkB,EAAIH,OAAtB,EAA+BI,OAA/B,CAAuC,CAAvC,CAApB,CACA,KAAKtC,KAAL,CAAWW,WAAX,CAAyByB,MAAM,CAACC,UAAP,CAAkB,KAAKrC,KAAL,CAAWY,QAAX,CAAsB,KAAKZ,KAAL,CAAWmC,MAAnD,EAA2DG,OAA3D,CAAmE,CAAnE,CAAzB,CAEArC,OAAO,CAACC,GAAR,CAAY,KAAKF,KAAL,CAAWmC,MAAvB,EACAlC,OAAO,CAACC,GAAR,CAAY,KAAKF,KAAL,CAAWW,WAAvB,E,uBAEiBa,CAAAA,KAAK,CAAC,kBAAD,CAAqB,CACvCC,MAAM,CAAE,MAD+B,CAEvCC,OAAO,CAAE,CACL,SAAU,mBADL,CAEL,eAAgB,mBAFX,CAF8B,CAArB,C,SAAlBa,I,sCAQgBA,CAAAA,IAAI,CAACX,IAAL,E,SAAhBY,O,eACJvC,OAAO,CAACC,GAAR,CAAY,QAAZ,EACAD,OAAO,CAACC,GAAR,CAAYsC,OAAZ,EACAvC,OAAO,CAACC,GAAR,CAAYsC,OAAO,CAACV,IAAR,CAAaP,MAAzB,EAEA,IAASkB,CAAT,CAAa,CAAb,CAAgBA,CAAC,CAAGD,OAAO,CAACV,IAAR,CAAaP,MAAjC,CAAyCkB,CAAC,EAA1C,CAA8C,CAC1C,KAAKzC,KAAL,CAAWa,QAAX,CAAoBC,OAApB,CAA4B4B,IAA5B,CAAiCF,OAAO,CAACV,IAAR,CAAaW,CAAb,EAAgB3B,OAAjD,EACA,KAAKd,KAAL,CAAWa,QAAX,CAAoBE,IAApB,CAAyB2B,IAAzB,CAA8BF,OAAO,CAACV,IAAR,CAAaW,CAAb,EAAgBE,WAA9C,EAEA;AACA;AACH,CAED1C,OAAO,CAACC,GAAR,CAAY,wBAAZ,EACAD,OAAO,CAACC,GAAR,CAAY,KAAKF,KAAL,CAAWa,QAAvB,EAEA,KAAK+B,WAAL,G,iFAGA3C,OAAO,CAACC,GAAR,CAAY,KAAZ,EACAD,OAAO,CAACC,GAAR,c,uOA8BK2C,K,CAAOxB,C,CAAG,CACnB,GAAItB,CAAAA,MAAM,CAAG,KAAKC,KAAL,CAAWD,MAAxB,CACAA,MAAM,CAAC8C,KAAD,CAAN,CAAgBxB,CAAC,CAACyB,MAAF,CAASC,KAAzB,CACA,KAAKC,QAAL,CAAc,CAAEjD,MAAM,CAANA,MAAF,CAAd,EACH,C,yDAEiB,CACd,KAAKU,SAAL,CAAiB,CAAC,KAAKA,SAAvB,CACAR,OAAO,CAACC,GAAR,CAAY,eAAiB,KAAKO,SAAlC,EACA,KAAKmC,WAAL,GACA,OACH,C,6DAEmB,CAChB,KAAKlC,WAAL,CAAmB,CAAC,KAAKA,WAAzB,CACAT,OAAO,CAACC,GAAR,CAAY,eAAiB,KAAKQ,WAAlC,EACA,KAAKkC,WAAL,GACA,OACH,C,gCAEGG,K,CAAOE,W,CAAa,CACpB,MAAOF,CAAAA,KAAK,CAAGE,WAAf,CACH,C,uCAEQ,iBACLhD,OAAO,CAACC,GAAR,CAAY,eAAZ,EACA,mBACI,aAAK,SAAS,CAAC,WAAf,wBACI,aAAK,SAAS,CAAC,OAAf,wBACI,MAAC,KAAD,EAAO,mBAAmB,CAAE,IAA5B,wBACI,MAAC,KAAD,CAAO,MAAP,yBACI,KAAC,KAAD,CAAO,SAAP,mBADJ,cAEI,KAAC,KAAD,CAAO,SAAP,4BAFJ,cAGI,KAAC,KAAD,CAAO,SAAP,sBAHJ,cAII,KAAC,KAAD,CAAO,SAAP,oBAJJ,cAKI,KAAC,KAAD,CAAO,SAAP,2BALJ,cAMI,KAAC,KAAD,CAAO,SAAP,sBANJ,GADJ,cASI,KAAC,KAAD,CAAO,IAAP,wBACI,MAAC,KAAD,CAAO,GAAP,yBACI,KAAC,KAAD,CAAO,GAAP,wBACI,2BADJ,EADJ,cAII,KAAC,KAAD,CAAO,GAAP,gCAJJ,cAKI,KAAC,KAAD,CAAO,GAAP,yDALJ,cAMI,MAAC,KAAD,CAAO,GAAP,YAAY,KAAKF,KAAL,CAAWY,QAAvB,UANJ,cAOI,MAAC,KAAD,CAAO,GAAP,YAAY,KAAKZ,KAAL,CAAWW,WAAvB,QAPJ,cAQI,MAAC,KAAD,CAAO,GAAP,yBACI,KAAC,MAAD,EAAQ,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACuC,eAAL,EAAN,EAAjB,CAA+C,KAAK,CAAC,SAArD,qBADJ,cAEI,KAAC,MAAD,EAAQ,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACC,iBAAL,EAAN,EAAjB,CAAiD,KAAK,CAAC,WAAvD,sBAFJ,GARJ,GADJ,EATJ,GADJ,cA0BI,0CA1BJ,cA2BI,MAAC,KAAD,yBACI,MAAC,KAAD,CAAO,MAAP,yBACI,KAAC,KAAD,CAAO,SAAP,sBADJ,cAEI,KAAC,KAAD,CAAO,SAAP,4BAFJ,GADJ,cAKI,MAAC,KAAD,CAAO,IAAP,YACK,KAAKC,cAAL,EADL,cAEI,MAAC,KAAD,CAAO,GAAP,yBACI,KAAC,KAAD,CAAO,GAAP,6BADJ,cAEI,KAAC,KAAD,CAAO,GAAP,yBAFJ,GAFJ,GALJ,GA3BJ,GADJ,cA0CI,YAAK,SAAS,CAAC,QAAf,uBACI,MAAC,KAAD,EAAO,IAAI,CAAE,KAAK3C,SAAlB,CAA6B,kBAAgB,+BAA7C,wBACI,KAAC,KAAD,CAAO,MAAP,wBACI,KAAC,KAAD,CAAO,KAAP,EAAa,EAAE,CAAC,+BAAhB,+BADJ,EADJ,cAMI,MAAC,KAAD,CAAO,IAAP,yBACI,mFADJ,cAEI,gCAAG,iEAAH,EAFJ,cAGI,wBAHJ,cAII,qIAJJ,cAKI,+DALJ,GANJ,cAaI,KAAC,KAAD,CAAO,MAAP,wBACI,KAAC,MAAD,EAAQ,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACyC,eAAL,EAAN,EAAjB,mBADJ,EAbJ,GADJ,EA1CJ,cA6DI,YAAK,SAAS,CAAC,SAAf,uBACI,MAAC,KAAD,EAAO,IAAI,CAAE,KAAKxC,WAAlB,CAA+B,kBAAgB,+BAA/C,wBACI,KAAC,KAAD,CAAO,MAAP,wBACI,KAAC,KAAD,CAAO,KAAP,EAAa,EAAE,CAAC,+BAAhB,kCADJ,EADJ,cAMI,KAAC,KAAD,CAAO,IAAP,wBACI,YAAK,SAAS,CAAC,gBAAf,uBACI,MAAC,IAAD,EAAM,QAAQ,CAAE,KAAKd,UAAL,CAAgByD,IAAhB,CAAqB,IAArB,CAAhB,wBACI,MAAC,IAAD,CAAM,QAAN,yBACI,KAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAC,SAAf,CAAyB,IAAI,CAAC,SAA9B,CAAwC,KAAK,CAAC,SAA9C,CAAwD,WAAW,CAAC,mBAApE,CAAwF,SAAS,CAAC,IAAlG,CAAuG,IAAI,CAAC,aAA5G,CAA0H,IAAI,CAAC,MAA/H,CACI,QAAQ,CAAE,KAAKC,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAA6B,SAA7B,CADd,EADJ,cAGI,KAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAC,QAAf,CAAwB,IAAI,CAAC,QAA7B,CAAsC,KAAK,CAAC,QAA5C,CAAqD,WAAW,CAAC,yBAAjE,CAA2F,IAAI,CAAC,aAAhG,CACI,QAAQ,CAAE,KAAKC,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAA6B,QAA7B,CADd,CACsD,QAAQ,KAD9D,EAHJ,cAKI,KAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,CAAsB,IAAI,CAAC,QAA3B,CAAoC,KAAK,CAAC,SAA1C,sBALJ,GADJ,cAQI,aAAK,EAAE,CAAC,SAAR,wBACI,gHADJ,cAEI,yGAFJ,cAGI,gCAAG,mEAAH,EAHJ,GARJ,GADJ,EADJ,EANJ,cAwBI,KAAC,KAAD,CAAO,MAAP,wBACI,KAAC,MAAD,EAAQ,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACF,iBAAL,EAAN,EAAjB,mBADJ,EAxBJ,GADJ,EA7DJ,GADJ,CA8FH,C,oBA3QgB/D,KAAK,CAACmE,S,EAgR3B,cAAe7D,CAAAA,MAAf","sourcesContent":["import React from \"react\";\r\nimport Dashboard from './Dashboard';\r\nimport './Dashboard.scss';\r\nimport { Table, Button, Form } from 'tabler-react';\r\nimport { Modal } from 'react-bootstrap';\r\n\r\n\r\nclass Wallet extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.modalShow = false;\r\n        this.modalShowWD = false;\r\n        this.state = {\r\n            fields: {},\r\n            walletvalue: 0,\r\n            totalbtc: 0,\r\n            approved: {\r\n                address: [],\r\n                date: []\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    renderApproved() {\r\n        let obj = this.state.approved;\r\n        let cnt = 0\r\n        try {\r\n            Object.keys(obj).map(function () {\r\n                console.log(cnt)\r\n                console.log('approvingwall')\r\n                console.log(obj.address[cnt])\r\n                console.log(obj.date[cnt])\r\n                cnt +=1\r\n                return <Table.Row>  <Table.Col>1</Table.Col> <Table.Col>2</Table.Col> </Table.Row>\r\n            })\r\n        }\r\n        catch (e) {\r\n            console.log(e)\r\n            return;\r\n        }\r\n\r\n\r\n        return;\r\n\r\n        for (var i = 0; i < this.state.approved.address.length; i++) {\r\n            try {\r\n                console.log('approvingwall')\r\n                return (\r\n                    <Table.Row>\r\n                        <Table.Col>{this.state.approved.address[i]}</Table.Col>\r\n                        <Table.Col>{this.state.approved.date[i]}</Table.Col>\r\n                    </Table.Row>\r\n                )\r\n            }\r\n            catch (e) {\r\n                console.log(e)\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    async componentWillMount() {\r\n        try {\r\n            let res = await fetch('/overview', {\r\n                method: 'post',\r\n                headers: {\r\n                    'Accept': 'applcication/json',\r\n                    'Content-Type': 'applcication/json'\r\n                }\r\n            });\r\n\r\n            let result = await res.json();\r\n            console.log('start btc calc')\r\n            for (var i = 0; i < result.data.length; i++) {\r\n                if (result.data[i].type == 1) {\r\n                    this.state.totalbtc += result.data[i].amount\r\n                }\r\n                else {\r\n                    this.state.totalbtc -= result.data[i].amount\r\n                }\r\n            }\r\n            console.log(this.state.totalbtc)\r\n            console.log('end btc calc')\r\n            console.log('start get conversion')\r\n            let res2 = await fetch('https://blockchain.info/tobtc?currency=USD&value=1')\r\n            let result2 = await res2.json()\r\n            console.log(result2)\r\n            console.log('end get conversion')\r\n            this.state.usdbtc = Number.parseFloat(1 / result2).toFixed(2);\r\n            this.state.walletvalue = Number.parseFloat(this.state.totalbtc * this.state.usdbtc).toFixed(2)\r\n\r\n            console.log(this.state.usdbtc)\r\n            console.log(this.state.walletvalue)\r\n\r\n            let res3 = await fetch('/approvedWallets', {\r\n                method: 'post',\r\n                headers: {\r\n                    'Accept': 'applcication/json',\r\n                    'Content-Type': 'applcication/json'\r\n                }\r\n            });\r\n\r\n            let result3 = await res3.json();\r\n            console.log(\"result\")\r\n            console.log(result3)\r\n            console.log(result3.data.length)\r\n\r\n            for (var k = 0; k < result3.data.length; k++) {\r\n                this.state.approved.address.push(result3.data[k].address)\r\n                this.state.approved.date.push(result3.data[k].approveDate)\r\n\r\n                //this.state.approved.address.push(result3.data[k].address)\r\n                //this.state.approved.date.push(result3.data[k].approveDate);\r\n            }\r\n\r\n            console.log(\"filled approved state:\")\r\n            console.log(this.state.approved)\r\n\r\n            this.forceUpdate();\r\n        }\r\n        catch (e) {\r\n            console.log('exc')\r\n            console.log(e)\r\n        }\r\n\r\n    }\r\n\r\n    onWDsubmit = (event) => {\r\n        event.preventDefault();\r\n        let fields = this.state.fields;\r\n\r\n        console.log(fields['address'])\r\n        console.log(/^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,39}$/.test(fields['address']))\r\n        console.log(fields['amount'])\r\n        console.log(/^\\d+(.\\d+)*$/.test(fields['amount']))\r\n\r\n        // Address\r\n        if (!/^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,39}$/.test(fields['address'])) {\r\n            // Reset Address\r\n            alert('Enter a valid BTC Address')\r\n            return;\r\n        }\r\n\r\n        if (!/^\\d+(.\\d+)*$/.test(fields['amount'])) {\r\n            alert('Enter a valid numeric amount to pay out')\r\n            return;\r\n        }\r\n\r\n        document.getElementById(\"divHint\").style.display = \"inline-block\";\r\n        return;\r\n    }\r\n\r\n    handleChange(field, e) {\r\n        let fields = this.state.fields;\r\n        fields[field] = e.target.value;\r\n        this.setState({ fields });\r\n    }\r\n\r\n    switchModalShow() {\r\n        this.modalShow = !this.modalShow;\r\n        console.log(\"modalshow = \" + this.modalShow)\r\n        this.forceUpdate();\r\n        return;\r\n    }\r\n\r\n    switchModalWDShow() {\r\n        this.modalShowWD = !this.modalShowWD;\r\n        console.log(\"modalshow = \" + this.modalShowWD)\r\n        this.forceUpdate();\r\n        return;\r\n    }\r\n\r\n    USD(value, USDexchange) {\r\n        return value * USDexchange;\r\n    }\r\n\r\n    render() {\r\n        console.log('render called')\r\n        return (\r\n            <div className=\"dashboard\">\r\n                <div className=\"table\">\r\n                    <Table highlightRowOnHover={true}>\r\n                        <Table.Header>\r\n                            <Table.ColHeader>Type</Table.ColHeader>\r\n                            <Table.ColHeader>Friendly Name</Table.ColHeader>\r\n                            <Table.ColHeader>Address</Table.ColHeader>\r\n                            <Table.ColHeader>Value</Table.ColHeader>\r\n                            <Table.ColHeader>Value in USD</Table.ColHeader>\r\n                            <Table.ColHeader>Actions</Table.ColHeader>\r\n                        </Table.Header>\r\n                        <Table.Body>\r\n                            <Table.Row>\r\n                                <Table.Col>\r\n                                    <h4>BTC</h4>\r\n                                </Table.Col>\r\n                                <Table.Col>Long-Time-Storage</Table.Col>\r\n                                <Table.Col>bc1qm6qv2jdgjmt4krahrw9wpcyt5mmt7g8h5hz0av</Table.Col>\r\n                                <Table.Col>{this.state.totalbtc} BTC</Table.Col>\r\n                                <Table.Col>{this.state.walletvalue} $</Table.Col>\r\n                                <Table.Col>\r\n                                    <Button onClick={() => this.switchModalShow()} color=\"primary\">Deposit</Button>\r\n                                    <Button onClick={() => this.switchModalWDShow()} color=\"secondary\">Withdraw</Button>\r\n                                </Table.Col>\r\n                            </Table.Row>\r\n                        </Table.Body>\r\n                    </Table>\r\n                    <h4>Approved Addresses</h4>\r\n                    <Table>\r\n                        <Table.Header>\r\n                            <Table.ColHeader>Address</Table.ColHeader>\r\n                            <Table.ColHeader>Approval Date</Table.ColHeader>\r\n                        </Table.Header>\r\n                        <Table.Body>\r\n                            {this.renderApproved()}\r\n                            <Table.Row>\r\n                                <Table.Col>bc1qm6****5884</Table.Col>\r\n                                <Table.Col>2019-10-10</Table.Col>\r\n                            </Table.Row>\r\n                        </Table.Body>\r\n                    </Table>\r\n                </div>\r\n                <div classname=\"modalD\" >\r\n                    <Modal show={this.modalShow} aria-labelledby=\"contained-modal-title-vcenter\">\r\n                        <Modal.Header>\r\n                            <Modal.Title id=\"contained-modal-title-vcenter\">\r\n                                Deposit to Wallet\r\n                            </Modal.Title>\r\n                        </Modal.Header>\r\n                        <Modal.Body>\r\n                            <p>To deposit to this wallet, please use the following address:</p>\r\n                            <p><b>bc1qm6qv2jdgjmt4krahrw9wpcyt5mmt7g8h5hz0av</b></p>\r\n                            <p> </p>\r\n                            <p>Note: For safety reasons it is required to deposit a set amount of BTC to enable withdrawing to a new address.</p>\r\n                            <p>This process only needs to be done once.</p>\r\n                        </Modal.Body>\r\n                        <Modal.Footer>\r\n                            <Button onClick={() => this.switchModalShow()}>Close</Button>\r\n                        </Modal.Footer>\r\n                    </Modal>\r\n                </div>\r\n                <div classname=\"modalWD\" >\r\n                    <Modal show={this.modalShowWD} aria-labelledby=\"contained-modal-title-vcenter\">\r\n                        <Modal.Header>\r\n                            <Modal.Title id=\"contained-modal-title-vcenter\">\r\n                                Withdraw from Wallet\r\n                            </Modal.Title>\r\n                        </Modal.Header>\r\n                        <Modal.Body>\r\n                            <div classname=\"withdrawalForm\">\r\n                                <Form onSubmit={this.onWDsubmit.bind(this)}>\r\n                                    <Form.FieldSet>\r\n                                        <Form.Input id=\"address\" name=\"address\" label=\"Address\" placeholder=\"Receiving Address\" maxLength=\"35\" icon=\"credit-card\" type=\"text\"\r\n                                            onChange={this.handleChange.bind(this, \"address\")} />\r\n                                        <Form.Input id=\"amount\" name=\"amount\" label=\"Amount\" placeholder=\"(BTC) Withdrawal Amount\" icon=\"dollar-sign\"\r\n                                            onChange={this.handleChange.bind(this, \"amount\")} required />\r\n                                        <Button name=\"submit\" type=\"submit\" color=\"primary\">Withdraw</Button>\r\n                                    </Form.FieldSet>\r\n                                    <div id=\"divHint\">\r\n                                        <p>For safety reasons it is required to approve new addresses before withdrawing is allowed.</p>\r\n                                        <p>A new address is approved by a deposit surpassing the configured limit (0.02 BTC).</p>\r\n                                        <p><b>Approved Addresses have no withdrawal limit.</b></p>\r\n                                    </div>\r\n                                </Form>\r\n                            </div>\r\n                        </Modal.Body>\r\n                        <Modal.Footer>\r\n                            <Button onClick={() => this.switchModalWDShow()}>Close</Button>\r\n                        </Modal.Footer>\r\n                    </Modal>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default Wallet;"]},"metadata":{},"sourceType":"module"}